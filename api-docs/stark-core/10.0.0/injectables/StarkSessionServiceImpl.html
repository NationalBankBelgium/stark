<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@nationalbankbelgium/stark-core documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/material.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">@nationalbankbelgium/stark-core documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>StarkSessionServiceImpl</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/session/services/session.service.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#_devAuthenticationHeaders">_devAuthenticationHeaders</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#countdownStarted">countdownStarted</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#idle">idle</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Optional</span>
                                <a href="#keepalive">keepalive</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#logger">logger</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#routingService">routingService</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#session$">session$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#store">store</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#translateService">translateService</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#configureIdleService">configureIdleService</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#configureKeepaliveService">configureKeepaliveService</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#destroySession">destroySession</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getCurrentLanguage">getCurrentLanguage</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getCurrentUser">getCurrentUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#initializeSession">initializeSession</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#login">login</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#logout">logout</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#pauseUserActivityTracking">pauseUserActivityTracking</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#registerTransitionHook">registerTransitionHook</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#resumeUserActivityTracking">resumeUserActivityTracking</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#sendLogoutRequest">sendLogoutRequest</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setCurrentLanguage">setCurrentLanguage</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setDevAuthenticationHeaders">setDevAuthenticationHeaders</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#startIdleService">startIdleService</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#startKeepaliveService">startKeepaliveService</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#stopIdleService">stopIdleService</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#stopKeepaliveService">stopKeepaliveService</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#validateSessionConfig">validateSessionConfig</a>
                            </li>
                        </ul>
                    </td>
                </tr>





                    <tr>
                        <td class="col-md-4">
                            <h6><b>Accessors</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#devAuthenticationHeaders">devAuthenticationHeaders</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                                <span class="modifier">Public</span>
                        <code>constructor(store: <a href="../interfaces/StarkCoreApplicationState.html">Store<StarkCoreApplicationState></a>, logger: <a href="../interfaces/StarkLoggingService.html">StarkLoggingService</a>, routingService: <a href="../interfaces/StarkRoutingService.html">StarkRoutingService</a>, appConfig: <a href="../interfaces/StarkApplicationConfig.html">StarkApplicationConfig</a>, idle: Idle, injector: <a href="https://angular.io/api/core/Injector" target="_blank">Injector</a>, translateService: TranslateService, sessionConfig?: <a href="../interfaces/StarkSessionConfig.html">StarkSessionConfig</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="52" class="link-to-prism">src/modules/session/services/session.service.ts:52</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>store</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/StarkCoreApplicationState.html" target="_self" >Store&lt;StarkCoreApplicationState&gt;</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>logger</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/StarkLoggingService.html" target="_self" >StarkLoggingService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>routingService</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/StarkRoutingService.html" target="_self" >StarkRoutingService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>appConfig</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/StarkApplicationConfig.html" target="_self" >StarkApplicationConfig</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>idle</td>
                                                  
                                                        <td>
                                                                    <code>Idle</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>injector</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://angular.io/api/core/Injector" target="_blank" >Injector</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>translateService</td>
                                                  
                                                        <td>
                                                                    <code>TranslateService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>sessionConfig</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/StarkSessionConfig.html" target="_self" >StarkSessionConfig</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            Yes
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="configureIdleService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            configureIdleService
                        </b>
                        <a href="#configureIdleService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>configureIdleService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="270"
                            class="link-to-prism">src/modules/session/services/session.service.ts:270</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="configureKeepaliveService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            configureKeepaliveService
                        </b>
                        <a href="#configureKeepaliveService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>configureKeepaliveService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="321"
                            class="link-to-prism">src/modules/session/services/session.service.ts:321</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="destroySession"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            destroySession
                        </b>
                        <a href="#destroySession"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>destroySession()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="198"
                            class="link-to-prism">src/modules/session/services/session.service.ts:198</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Performs all the necessary actions to destroy the session. The user stored in the session is removed.
It dispatches a DESTROY_SESSION action to the NGRX-Store</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getCurrentLanguage"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            getCurrentLanguage
                        </b>
                        <a href="#getCurrentLanguage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getCurrentLanguage()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="392"
                            class="link-to-prism">src/modules/session/services/session.service.ts:392</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;string&gt;</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getCurrentUser"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            getCurrentUser
                        </b>
                        <a href="#getCurrentUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getCurrentUser()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="385"
                            class="link-to-prism">src/modules/session/services/session.service.ts:385</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;StarkUser | undefined&gt;</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="initializeSession"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            initializeSession
                        </b>
                        <a href="#initializeSession"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>initializeSession(user: StarkUser)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="187"
                            class="link-to-prism">src/modules/session/services/session.service.ts:187</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Performs all the necessary actions to initialize the session.
It dispatches a INITIALIZE_SESSION action to the NGRX-Store</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>user</td>
                                    <td>
                                            <code>StarkUser</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <ul>
<li>The user used to initialize the session.</li>
</ul>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="login"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            login
                        </b>
                        <a href="#login"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>login(user: StarkUser)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="205"
                            class="link-to-prism">src/modules/session/services/session.service.ts:205</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>user</td>
                                    <td>
                                            <code>StarkUser</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="logout"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            logout
                        </b>
                        <a href="#logout"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>logout()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="212"
                            class="link-to-prism">src/modules/session/services/session.service.ts:212</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pauseUserActivityTracking"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            pauseUserActivityTracking
                        </b>
                        <a href="#pauseUserActivityTracking"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>pauseUserActivityTracking()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="258"
                            class="link-to-prism">src/modules/session/services/session.service.ts:258</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="registerTransitionHook"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            registerTransitionHook
                        </b>
                        <a href="#registerTransitionHook"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>registerTransitionHook()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="147"
                            class="link-to-prism">src/modules/session/services/session.service.ts:147</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resumeUserActivityTracking"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            resumeUserActivityTracking
                        </b>
                        <a href="#resumeUserActivityTracking"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resumeUserActivityTracking()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="263"
                            class="link-to-prism">src/modules/session/services/session.service.ts:263</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sendLogoutRequest"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            sendLogoutRequest
                        </b>
                        <a href="#sendLogoutRequest"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>sendLogoutRequest(url: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, serializedData: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, async: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank">boolean</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="222"
                            class="link-to-prism">src/modules/session/services/session.service.ts:222</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>url</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                </tr>
                                <tr>
                                    <td>serializedData</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                </tr>
                                <tr>
                                    <td>async</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>true</code>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>Observable&lt;void&gt;</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setCurrentLanguage"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            setCurrentLanguage
                        </b>
                        <a href="#setCurrentLanguage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>setCurrentLanguage(newLanguage: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="399"
                            class="link-to-prism">src/modules/session/services/session.service.ts:399</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>newLanguage</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setDevAuthenticationHeaders"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            setDevAuthenticationHeaders
                        </b>
                        <a href="#setDevAuthenticationHeaders"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>setDevAuthenticationHeaders(devAuthenticationHeaders: Map<string | string | []>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="349"
                            class="link-to-prism">src/modules/session/services/session.service.ts:349</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>devAuthenticationHeaders</td>
                                    <td>
                                            <code>Map&lt;string | string | []&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="startIdleService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            startIdleService
                        </b>
                        <a href="#startIdleService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>startIdleService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="363"
                            class="link-to-prism">src/modules/session/services/session.service.ts:363</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="startKeepaliveService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            startKeepaliveService
                        </b>
                        <a href="#startKeepaliveService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>startKeepaliveService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="372"
                            class="link-to-prism">src/modules/session/services/session.service.ts:372</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stopIdleService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            stopIdleService
                        </b>
                        <a href="#stopIdleService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>stopIdleService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="367"
                            class="link-to-prism">src/modules/session/services/session.service.ts:367</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stopKeepaliveService"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            stopKeepaliveService
                        </b>
                        <a href="#stopKeepaliveService"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>stopKeepaliveService()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="379"
                            class="link-to-prism">src/modules/session/services/session.service.ts:379</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateSessionConfig"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Protected</span>
                            validateSessionConfig
                        </b>
                        <a href="#validateSessionConfig"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>validateSessionConfig(customConfig: <a href="../interfaces/StarkSessionConfig.html">StarkSessionConfig</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="109"
                            class="link-to-prism">src/modules/session/services/session.service.ts:109</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Validates the StarkSessionConfig provided.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>customConfig</td>
                                    <td>
                                                <code><a href="../interfaces/StarkSessionConfig.html" target="_self" >StarkSessionConfig</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <ul>
<li>Custom configuration object passed via the StarkSessionModule.forRoot() method</li>
</ul>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="_devAuthenticationHeaders"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            _devAuthenticationHeaders</b>
                            <a href="#_devAuthenticationHeaders"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>new Map&lt;string, string | string[]&gt;()</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="51" class="link-to-prism">src/modules/session/services/session.service.ts:51</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="countdownStarted"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            countdownStarted</b>
                            <a href="#countdownStarted"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>false</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="52" class="link-to-prism">src/modules/session/services/session.service.ts:52</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="idle"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            idle</b>
                            <a href="#idle"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Idle</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="61" class="link-to-prism">src/modules/session/services/session.service.ts:61</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="keepalive"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                                <span class="modifier">Optional</span>
                            keepalive</b>
                            <a href="#keepalive"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Keepalive</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="49" class="link-to-prism">src/modules/session/services/session.service.ts:49</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="logger"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            logger</b>
                            <a href="#logger"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/StarkLoggingService.html" target="_self" >StarkLoggingService</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <b>Decorators : </b>
                            <br />
                            <code>
                                @Inject(STARK_LOGGING_SERVICE)<br />
                            </code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="58" class="link-to-prism">src/modules/session/services/session.service.ts:58</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="routingService"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            routingService</b>
                            <a href="#routingService"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/StarkRoutingService.html" target="_self" >StarkRoutingService</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <b>Decorators : </b>
                            <br />
                            <code>
                                @Inject(STARK_ROUTING_SERVICE)<br />
                            </code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="59" class="link-to-prism">src/modules/session/services/session.service.ts:59</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="session$"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            session$</b>
                            <a href="#session$"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/StarkSession.html" target="_self" >Observable&lt;StarkSession&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="50" class="link-to-prism">src/modules/session/services/session.service.ts:50</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="store"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            store</b>
                            <a href="#store"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/StarkCoreApplicationState.html" target="_self" >Store&lt;StarkCoreApplicationState&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="57" class="link-to-prism">src/modules/session/services/session.service.ts:57</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="translateService"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            translateService</b>
                            <a href="#translateService"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>TranslateService</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="63" class="link-to-prism">src/modules/session/services/session.service.ts:63</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

            <section>
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="devAuthenticationHeaders"></a>
                        <span class="name"><b>devAuthenticationHeaders</b><a href="#devAuthenticationHeaders"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>devAuthenticationHeaders()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="359" class="link-to-prism">src/modules/session/services/session.service.ts:359</a></div>
                                </td>
                            </tr>

            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { HttpHeaders, HttpRequest } from &quot;@angular/common/http&quot;;
import { Inject, Injectable, Injector, Optional } from &quot;@angular/core&quot;;
import { DEFAULT_INTERRUPTSOURCES, Idle } from &quot;@ng-idle/core&quot;;
import { Keepalive } from &quot;@ng-idle/keepalive&quot;;
import { TranslateService } from &quot;@ngx-translate/core&quot;;
import { select, Store } from &quot;@ngrx/store&quot;;
import { StateObject } from &quot;@uirouter/core&quot;;
import { validateSync } from &quot;class-validator&quot;;
import { defer, Observable, Subject } from &quot;rxjs&quot;;
import { distinctUntilChanged, map, take } from &quot;rxjs/operators&quot;;

import { STARK_LOGGING_SERVICE, StarkLoggingService } from &quot;../../logging/services&quot;;
import { StarkSessionService, starkSessionServiceName } from &quot;./session.service.intf&quot;;
import { STARK_ROUTING_SERVICE, StarkRoutingService, StarkRoutingTransitionHook } from &quot;../../routing/services&quot;;
import { STARK_APP_CONFIG, StarkApplicationConfig } from &quot;../../../configuration/entities/application&quot;;
import { STARK_SESSION_CONFIG, StarkSession, StarkSessionConfig } from &quot;../entities&quot;;
import { StarkUser } from &quot;../../user/entities&quot;;
import {
	StarkChangeLanguage,
	StarkChangeLanguageFailure,
	StarkChangeLanguageSuccess,
	StarkDestroySession,
	StarkDestroySessionSuccess,
	StarkInitializeSession,
	StarkInitializeSessionSuccess,
	StarkSessionLogout,
	StarkSessionTimeoutCountdownFinish,
	StarkSessionTimeoutCountdownStart,
	StarkSessionTimeoutCountdownStop,
	StarkUserActivityTrackingPause,
	StarkUserActivityTrackingResume
} from &quot;../actions&quot;;
import { StarkHttpStatusCodes } from &quot;../../http/enumerators&quot;;
import { StarkHttpHeaders } from &quot;../../http/constants&quot;;
import { StarkCoreApplicationState } from &quot;../../../common/store&quot;;
import { selectStarkSession } from &quot;../reducers&quot;;
import { StarkConfigurationUtil } from &quot;../../../util/configuration.util&quot;;
import { StarkValidationErrorsUtil } from &quot;../../../util/validation-errors.util&quot;;
import { starkAppExitStateName, starkAppInitStateName, starkSessionExpiredStateName } from &quot;../constants&quot;;

/**
 * @ignore
 */
export const starkUnauthenticatedUserError &#x3D; &quot;StarkSessionService &#x3D;&gt; user not authenticated&quot;;

@Injectable()
export class StarkSessionServiceImpl implements StarkSessionService {
	public keepalive?: Keepalive;
	public session$: Observable&lt;StarkSession&gt;;
	protected _devAuthenticationHeaders &#x3D; new Map&lt;string, string | string[]&gt;();
	public countdownStarted &#x3D; false;

	// TODO Check if we can simplify this service
	/* tslint:disable-next-line:parameters-max-number */
	public constructor(
		public store: Store&lt;StarkCoreApplicationState&gt;,
		@Inject(STARK_LOGGING_SERVICE) public logger: StarkLoggingService,
		@Inject(STARK_ROUTING_SERVICE) public routingService: StarkRoutingService,
		@Inject(STARK_APP_CONFIG) private appConfig: StarkApplicationConfig,
		public idle: Idle,
		injector: Injector,
		public translateService: TranslateService,
		@Optional()
		@Inject(STARK_SESSION_CONFIG)
		private sessionConfig?: StarkSessionConfig
	) {
		// ensuring that the app config is valid before doing anything
		StarkConfigurationUtil.validateConfig(this.appConfig, [&quot;session&quot;], starkSessionServiceName);

		// ensuring that the session config is valid before doing anything
		if (this.sessionConfig) {
			this.validateSessionConfig(this.sessionConfig);
		}

		if (this.idle.getKeepaliveEnabled() &amp;&amp; !this.appConfig.keepAliveDisabled) {
			this.keepalive &#x3D; injector.get&lt;Keepalive&gt;(Keepalive);
		}

		this.registerTransitionHook();

		this.configureIdleService();
		this.configureKeepaliveService();

		this.session$ &#x3D; this.store.pipe(select(selectStarkSession));

		if (window) {
			window.addEventListener(&quot;beforeunload&quot;, (_ev: BeforeUnloadEvent) &#x3D;&gt; {
				// Hit the logout URL before leaving the application.
				// We need to call the REST service synchronously,
				// because the browser has to wait for the HTTP call to complete.

				// dispatch action so an effect can run any logic if needed
				this.store.dispatch(new StarkSessionLogout());
				this.sendLogoutRequest(this.appConfig.logoutUrl, &quot;&quot;, false);
				// in this case, since the HTTP call is synchronous, the session can be destroy immediately
				this.destroySession();
			});
		}

		this.logger.debug(starkSessionServiceName + &quot; loaded&quot;);
	}

	/**
	 * Validates the StarkSessionConfig provided.
	 * @param customConfig - Custom configuration object passed via the StarkSessionModule.forRoot() method
	 * @throws In case the configuration object passed via the StarkSessionModule.forRoot() method is not valid
	 */
	protected validateSessionConfig(customConfig: StarkSessionConfig): void {
		const invalidConfigErrorPrefix: string &#x3D; starkSessionServiceName + &quot;: invalid StarkSessionConfig object. &quot;;
		const invalidConfigErrorAppInitSuffix: string &#x3D;
			&quot; should have the prefix &#x27;&quot; + starkAppInitStateName + &quot;.&#x27; in order to be configured correctly as an application initial state&quot;;
		const invalidConfigErrorAppExitSuffix: string &#x3D;
			&quot; should have the prefix &#x27;&quot; + starkAppExitStateName + &quot;.&#x27; in order to be configured correctly as an application exit state&quot;;

		// validate config to ensure that the init/exit states have the correct StarkAppInit or StarkAppExit parent
		if (
			typeof customConfig.loginStateName !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;
			(!customConfig.loginStateName.startsWith(starkAppInitStateName) ||
				customConfig.loginStateName.replace(starkAppInitStateName, &quot;&quot;).length &lt; 2)
		) {
			throw new Error(invalidConfigErrorPrefix + &quot;&#x27;loginStateName&#x27; value&quot; + invalidConfigErrorAppInitSuffix);
		}
		if (
			typeof customConfig.preloadingStateName !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;
			(!customConfig.preloadingStateName.startsWith(starkAppInitStateName) ||
				customConfig.preloadingStateName.replace(starkAppInitStateName, &quot;&quot;).length &lt; 2)
		) {
			throw new Error(invalidConfigErrorPrefix + &quot;&#x27;preloadingStateName&#x27; value&quot; + invalidConfigErrorAppInitSuffix);
		}
		if (
			typeof customConfig.sessionExpiredStateName !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;
			(!customConfig.sessionExpiredStateName.startsWith(starkAppExitStateName) ||
				customConfig.sessionExpiredStateName.replace(starkAppExitStateName, &quot;&quot;).length &lt; 2)
		) {
			throw new Error(invalidConfigErrorPrefix + &quot;&#x27;sessionExpiredStateName&#x27; value&quot; + invalidConfigErrorAppExitSuffix);
		}
		if (
			typeof customConfig.sessionLogoutStateName !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;
			(!customConfig.sessionLogoutStateName.startsWith(starkAppExitStateName) ||
				customConfig.sessionLogoutStateName.replace(starkAppExitStateName, &quot;&quot;).length &lt; 2)
		) {
			throw new Error(invalidConfigErrorPrefix + &quot;&#x27;sessionLogoutStateName&#x27; value&quot; + invalidConfigErrorAppExitSuffix);
		}
	}

	protected registerTransitionHook(): void {
		this.routingService.addKnownNavigationRejectionCause(starkUnauthenticatedUserError);

		this.routingService.addTransitionHook(
			StarkRoutingTransitionHook.ON_BEFORE,
			{
				// match any state except the ones that are children of starkAppInit/starkAppExit or the Ui-Router&#x27;s root state
				entering: (state?: StateObject): boolean &#x3D;&gt; {
					if (state &amp;&amp; typeof state.name !&#x3D;&#x3D; &quot;undefined&quot;) {
						const regexInitExitStateName: RegExp &#x3D; new RegExp(&quot;(&quot; + starkAppInitStateName + &quot;|&quot; + starkAppExitStateName + &quot;)&quot;);
						return !state.name.match(regexInitExitStateName) &amp;&amp; !(state.abstract &amp;&amp; state.name &#x3D;&#x3D;&#x3D; &quot;&quot;);
					} else {
						return true; // always match
					}
				}
			},
			(): Promise&lt;boolean&gt; &#x3D;&gt; {
				return this.session$
					.pipe(
						take(1),
						map((session: StarkSession) &#x3D;&gt; {
							if (typeof session.user &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) {
								// reject transition in case there is no user in the session
								throw new Error(starkUnauthenticatedUserError);
							} else {
								return true;
							}
						})
					)
					.toPromise&lt;boolean&gt;();
			},
			{ priority: 1000 } // very high priority (this hook should be the first one to be called to reject transitions immediately)
		);
	}

	/**
	 * Performs all the necessary actions to initialize the session.
	 * It dispatches a INITIALIZE_SESSION action to the NGRX-Store
	 * @param user - The user used to initialize the session.
	 */
	protected initializeSession(user: StarkUser): void {
		this.store.dispatch(new StarkInitializeSession(user));
		this.startIdleService();
		this.startKeepaliveService();
		this.store.dispatch(new StarkInitializeSessionSuccess());
	}

	/**
	 * Performs all the necessary actions to destroy the session. The user stored in the session is removed.
	 * It dispatches a DESTROY_SESSION action to the NGRX-Store
	 */
	protected destroySession(): void {
		this.store.dispatch(new StarkDestroySession());
		this.stopIdleService();
		this.stopKeepaliveService();
		this.store.dispatch(new StarkDestroySessionSuccess());
	}

	public login(user: StarkUser): void {
		// use class-validator to validate the object based on the entity StarkUser
		StarkValidationErrorsUtil.throwOnError(validateSync(user), starkSessionServiceName + &quot;: invalid user profile.&quot;);

		this.initializeSession(user);
	}

	public logout(): void {
		// dispatch action so an effect can run any logic if needed
		this.store.dispatch(new StarkSessionLogout());
		// the session will always be destroyed right after the response of the logout HTTP call (regardless of its result)
		this.sendLogoutRequest(this.appConfig.logoutUrl, &quot;&quot;, true).subscribe(
			() &#x3D;&gt; this.destroySession(),
			() &#x3D;&gt; this.destroySession()
		);
	}

	protected sendLogoutRequest(url: string, serializedData: string, async: boolean &#x3D; true): Observable&lt;void&gt; {
		const httpRequest$: Subject&lt;void&gt; &#x3D; new Subject&lt;void&gt;();

		const emitXhrResult &#x3D; (xhrRequest: XMLHttpRequest): void &#x3D;&gt; {
			if (xhrRequest.readyState &#x3D;&#x3D;&#x3D; XMLHttpRequest.DONE) {
				if (xhrRequest.status &#x3D;&#x3D;&#x3D; StarkHttpStatusCodes.HTTP_200_OK || xhrRequest.status &#x3D;&#x3D;&#x3D; StarkHttpStatusCodes.HTTP_201_CREATED) {
					httpRequest$.next();
					httpRequest$.complete();
				} else {
					httpRequest$.error(xhrRequest.status);
				}
			}
		};

		const xhr: XMLHttpRequest &#x3D; new XMLHttpRequest();

		if (async) {
			xhr.onreadystatechange &#x3D; (): void &#x3D;&gt; emitXhrResult(xhr);
		} else {
			emitXhrResult(xhr);
		}

		// catch any error raised by the browser while opening the connection. for example:
		// Chrome &quot;mixed content&quot; error: https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content
		// IE &quot;Access is denied&quot; error: https://stackoverflow.com/questions/22098259/access-denied-in-ie-10-and-11-when-ajax-target-is-localhost
		try {
			xhr.open(&quot;GET&quot;, url, async);
			xhr.setRequestHeader(StarkHttpHeaders.CONTENT_TYPE, &quot;application/json&quot;);
			xhr.send(serializedData);
		} catch (e) {
			httpRequest$.error(e);
		}

		return httpRequest$;
	}

	public pauseUserActivityTracking(): void {
		this.store.dispatch(new StarkUserActivityTrackingPause());
		this.idle.clearInterrupts();
	}

	public resumeUserActivityTracking(): void {
		this.store.dispatch(new StarkUserActivityTrackingResume());
		this.idle.setInterrupts(DEFAULT_INTERRUPTSOURCES);
		this.startIdleService();
		this.startKeepaliveService();
	}

	protected configureIdleService(): void {
		// ensuring that the session timeout values are valid to prevent errors while setting the idle value
		if (this.appConfig.sessionTimeoutWarningPeriod &gt;&#x3D; this.appConfig.sessionTimeout) {
			const errorMsg &#x3D; &#x60;${starkSessionServiceName}: ${STARK_APP_CONFIG} constant is not valid.\n\n- sessionTimeoutWarningPeriod cannot be equal or higher than sessionTimeout\n&#x60;;

			throw new Error(errorMsg);
		}

		// seconds before the user is considered to be idle (should be calculated subtracting the timeout warning period)
		this.idle.setIdle(this.appConfig.sessionTimeout - this.appConfig.sessionTimeoutWarningPeriod);
		// seconds before the session times out and the timeout warning event should be emitted
		this.idle.setTimeout(this.appConfig.sessionTimeoutWarningPeriod);
		// sets the default interrupts (clicks, scrolls, touches to the document)
		this.idle.setInterrupts(DEFAULT_INTERRUPTSOURCES);

		this.idle.onIdleStart.subscribe(() &#x3D;&gt; this.logger.warn(starkSessionServiceName + &quot;: the user has gone idle&quot;));
		this.idle.onIdleEnd.subscribe(() &#x3D;&gt; {
			this.logger.info(starkSessionServiceName + &quot;: the user is no longer idle&quot;);
			if (this.countdownStarted) {
				this.countdownStarted &#x3D; false;
				// dispatch action so an effect can run any logic if needed
				this.store.dispatch(new StarkSessionTimeoutCountdownStop());
			}
		});

		this.idle.onTimeout.subscribe(() &#x3D;&gt; {
			this.logger.warn(starkSessionServiceName + &quot;: the user session has timed out!&quot;);
			// dispatch action so an effect can run any logic if needed
			this.store.dispatch(new StarkSessionTimeoutCountdownFinish());
			this.logout();

			let sessionExpiredStateName: string &#x3D; starkSessionExpiredStateName;
			if (
				this.sessionConfig &amp;&amp;
				typeof this.sessionConfig.sessionExpiredStateName !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp;
				this.sessionConfig.sessionExpiredStateName !&#x3D;&#x3D; &quot;&quot;
			) {
				sessionExpiredStateName &#x3D; this.sessionConfig.sessionExpiredStateName;
			}
			this.routingService.navigateTo(sessionExpiredStateName);
		});

		this.idle.onTimeoutWarning.subscribe((countdown: number) &#x3D;&gt; {
			if (countdown &#x3D;&#x3D;&#x3D; this.idle.getTimeout()) {
				this.countdownStarted &#x3D; true;
				// dispatch action so an effect can run any logic if needed (i.e. displaying a timeout countdown dialog)
				this.store.dispatch(new StarkSessionTimeoutCountdownStart(countdown));
			}
		});
	}

	public configureKeepaliveService(): void {
		if (!this.keepalive) {
			return;
		}

		this.keepalive.interval(this.appConfig.keepAliveInterval); // ping interval in seconds

		let pingRequestHeaders: HttpHeaders &#x3D; new HttpHeaders();

		if (ENV &#x3D;&#x3D;&#x3D; &quot;development&quot;) {
			this.devAuthenticationHeaders.forEach((value: string | string[], key: string) &#x3D;&gt; {
				pingRequestHeaders &#x3D; pingRequestHeaders.set(key, value);
			});
		}
		// Add the correlation ID header to the ping requests
		if (this.logger.correlationIdHttpHeaderName &amp;&amp; this.logger.correlationIdHttpHeaderName.length &gt; 0 &amp;&amp; this.logger.correlationId) {
			pingRequestHeaders &#x3D; pingRequestHeaders.set(this.logger.correlationIdHttpHeaderName, this.logger.correlationId);
		}

		const pingRequest: HttpRequest&lt;void&gt; &#x3D; new HttpRequest(&quot;GET&quot;, &lt;string&gt;this.appConfig.keepAliveUrl, {
			headers: pingRequestHeaders
		});

		// the XSRF config for this request will be automatically added by the XSRF Http Interceptor
		this.keepalive.request(pingRequest);
		this.keepalive.onPing.subscribe(() &#x3D;&gt; this.logger.info(starkSessionServiceName + &quot;: keepAlive ping sent&quot;));
	}

	public setDevAuthenticationHeaders(devAuthenticationHeaders: Map&lt;string, string | string[]&gt;): void {
		this.logger.debug(starkSessionServiceName + &quot;: constructing the authentication headers&quot;);
		devAuthenticationHeaders.forEach((value: string | string[], key: string) &#x3D;&gt; {
			// in Angular, a header value can only be string or string[], not null/undefined (https://github.com/angular/angular/issues/18743)
			if (key &amp;&amp; typeof value !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp; value !&#x3D;&#x3D; null) {
				this._devAuthenticationHeaders.set(key, value);
			}
		});
	}

	public get devAuthenticationHeaders(): Map&lt;string, string | string[]&gt; {
		return this._devAuthenticationHeaders;
	}

	protected startIdleService(): void {
		this.idle.watch();
	}

	protected stopIdleService(): void {
		this.idle.stop();
		this.idle.clearInterrupts();
	}

	protected startKeepaliveService(): void {
		if (this.keepalive) {
			// the Keepalive service is automatically started by the Idle service
			this.keepalive.ping();
		}
	}

	protected stopKeepaliveService(): void {
		if (this.keepalive) {
			this.keepalive.stop();
		}
	}

	public getCurrentUser(): Observable&lt;StarkUser | undefined&gt; {
		return this.session$.pipe(
			map((session: StarkSession) &#x3D;&gt; session.user),
			distinctUntilChanged() // using distinctUntilChanged to make sure to only emit on values different from the last one, to prevent infinite loops.
		);
	}

	public getCurrentLanguage(): Observable&lt;string&gt; {
		return this.session$.pipe(
			map((session: StarkSession) &#x3D;&gt; session.currentLanguage),
			distinctUntilChanged() // using distinctUntilChanged to make sure to only emit on values different from the last one, to prevent infinite loops.
		);
	}

	public setCurrentLanguage(newLanguage: string): void {
		// dispatch corresponding action to allow the user to trigger his own effects if needed
		this.store.dispatch(new StarkChangeLanguage(newLanguage));

		defer(() &#x3D;&gt; this.translateService.use(newLanguage)).subscribe(
			(_translations: any) &#x3D;&gt; this.store.dispatch(new StarkChangeLanguageSuccess(newLanguage)),
			(error: any) &#x3D;&gt; this.store.dispatch(new StarkChangeLanguageFailure(error))
		);
	}
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'StarkSessionServiceImpl.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
